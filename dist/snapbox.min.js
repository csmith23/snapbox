!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react"),require("react-jss"),require("prop-types"),require("classnames")):"function"==typeof define&&define.amd?define(["react","react-jss","prop-types","classnames"],e):t.snapbox=e(t.React,t.withStyles,t.PropTypes,t.classnames)}(this,function(t,e,s,i){"use strict";var o="default"in t?t.default:t,a="default"in e?e.default:e;s=s&&s.hasOwnProperty("default")?s.default:s,i=i&&i.hasOwnProperty("default")?i.default:i;class l extends t.Component{constructor(t){super(t),this.childCallback=((t,e,s)=>{this.state.snapchildren[t]=s,this.state.width<e.width&&(this.state.width=e.width),this.state.height<e.height&&(this.state.height=e.height)}),this.updateDimensions=(()=>{this.state.width=this.state.height=0,this.state.refchildren.forEach(t=>{this.state.width<t.current.offsetWidth&&(this.state.width=t.current.offsetWidth),this.state.height<t.current.offsetHeight&&(this.state.height=t.current.offsetHeight)}),null!==this.state.refclassname.current&&(this.state.width<this.state.refclassname.current.offsetWidth&&(this.state.width=this.state.refclassname.current.offsetWidth),this.state.height<this.state.refclassname.current.offsetHeight&&(this.state.height=this.state.refclassname.current.offsetHeight)),null!==this.props.mountCallback?this.props.mountCallback(this.props.name,{width:this.state.width,height:this.state.height},this.getPointPosition):this.setState({})}),this.getPointPosition=(t=>{let e={x:0,y:0};return t.includes("top")?e.y=this.state.top:t.includes("bottom")?e.y=this.state.top+this.state.height:e.y=this.state.top+this.state.height/2,t.includes("left")?e.x=this.state.left:t.includes("right")?e.x=this.state.left+this.state.width:e.x=this.state.left+this.state.width/2,e}),this.getPointPositionForChildren=(t=>{let e={x:0,y:0};return t.includes("top")?e.y=0:t.includes("bottom")?e.y=this.state.height:e.y=this.state.height/2,t.includes("left")?e.x=0:t.includes("right")?e.x=this.state.width:e.x=this.state.width/2,e}),this.state={first_render:!0,top:0,left:0,width:null,height:null,rendered:!1,siblings:[],snapchildren:{},refchildren:[],refclassname:o.createRef()}}render(){if(this.state.first_render)return this.state.first_render=!1,o.createElement("div",{className:this.props.classes.snapbox,style:{top:this.state.top,left:this.state.left,height:this.state.height,width:this.state.width}},o.createElement("div",{className:this.props.className,ref:this.state.refclassname},o.Children.map(this.props.children,t=>t.props.is_snapbox?o.cloneElement(t,{mountCallback:this.childCallback}):o.cloneElement(t,{ref:t=>{this.state.refchildren.push(t)}}))));let t,e,s,i,a,l,n,h;if(t=!1,e={x:null,y:null},s={x:null,y:null},i={x:null,y:null},a={x:null,y:null},l=n=h=!1,this.props.processedsnaps.forEach(o=>{let r=o.locator(o.snappoint);o.localpoint.includes("top")?(h=!0,o.localpoint.includes("left")||(s.y=r.y),o.localpoint.includes("right")||(e.y=r.y)):o.localpoint.includes("bottom")&&(h=!0,o.localpoint.includes("left")||(a.y=r.y),o.localpoint.includes("right")||(i.y=r.y)),o.localpoint.includes("left")?(n=!0,o.localpoint.includes("top")||(i.x=r.x),o.localpoint.includes("bottom")||(e.x=r.x)):o.localpoint.includes("right")&&(n=!0,o.localpoint.includes("top")||(a.x=r.x),o.localpoint.includes("bottom")||(s.x=r.x)),"center"===o.localpoint&&(t=r,l=!0)}),e.y=s.y=Math.max(e.y,s.y),i.y=a.y=null===i.y?null===a.y?0:a.y:null===a.y?bottomrleft.y:Math.min(i.y,a.y),e.x=i.x=Math.max(e.x,i.x),s.x=a.x=null===s.x?null===a.x?0:a.x:null===a.x?s.x:Math.min(s.x,a.x),l){let o,l;o=h?Math.min(t.y-e.y,i.y-t.y):this.state.height/2,e.y=s.y=t.y-o,i.y=a.y=t.y+o,l=n?Math.min(t.x-e.x,s.x-t.x):this.state.width/2,e.x=i.x=t.x-l,s.x=a.x=t.x+l}let r=s.x-e.x;r<this.state.width&&(e.x=i.x=e.x-(this.state.width-r)/2,s.x=a.x=s.x+(this.state.width+r)/2);let p=i.y-e.y;return p<this.state.height&&(e.y=s.y=e.y-(this.state.height-p)/2,i.y=a.y=i.y-(this.state.height+p)/2),(l||n||h)&&(this.state.top=e.y,this.state.left=e.x,this.state.height=i.y-e.y,this.state.width=s.x-e.x),o.createElement("div",{className:this.props.classes.snapbox,style:{top:this.state.top,left:this.state.left,height:this.state.height,width:this.state.width}},o.createElement("div",{className:this.props.className,ref:this.state.refclassname},o.Children.map(this.props.children,t=>t.props.is_snapbox?o.cloneElement(t,{mountCallback:this.childCallback,processedsnaps:t.props.snaps.map(t=>"parent"===t.locator?{locator:this.getPointPositionForChildren,localpoint:t.localpoint,snappoint:t.snappoint}:{locator:this.state.snapchildren[t.locator],localpoint:t.localpoint,snappoint:t.snappoint})}):o.cloneElement(t,{ref:t=>{this.state.refchildren.push(t)}}))))}componentDidMount(){this.updateDimensions(),window.addEventListener("resize",this.updateDimensions)}componentWillUnmount(){window.removeEventListener("resize",this.updateDimensions)}}return l.defaultProps={snaps:[],processedsnaps:[],mountCallback:null,is_snapbox:!0},l.propTypes={name:s.string,snaps:s.arrayOf(s.shape({locator:s.string,localpoint:s.oneOf(["top","left","center","right","bottom","topleft","topright","bottomright","bottomleft"]),snappoint:s.oneOf(["top","left","center","right","bottom","topleft","topright","bottomright","bottomleft"])})),processedsnaps:s.arrayOf(s.shape({locator:s.func,localpoint:s.oneOf(["top","left","center","right","bottom","topleft","topright","bottomright","bottomleft"]),snappoint:s.oneOf(["top","left","center","right","bottom","topleft","topright","bottomright","bottomleft"])})),mountCallback:s.func,is_snapbox:s.bool},a(t=>({snapbox:{position:"absolute",overflow:"hidden"}}))(l)});

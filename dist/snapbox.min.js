!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react"),require("prop-types")):"function"==typeof define&&define.amd?define(["react","prop-types"],e):t.snapbox=e(t.React,t.PropTypes)}(this,function(t,e){"use strict";var s="default"in t?t.default:t;e=e&&e.hasOwnProperty("default")?e.default:e;class i extends t.Component{constructor(t){super(t),this.childCallback=((t,e,s)=>{this.state.snapchildren[t]=s,this.state.width<e.width&&(this.state.width=e.width),this.state.height<e.height&&(this.state.height=e.height)}),this.updateDimensions=(()=>{this.state.width=this.state.height=0,this.state.refchildren.forEach(t=>{this.state.width<t.current.offsetWidth&&(this.state.width=t.current.offsetWidth),this.state.height<t.current.offsetHeight&&(this.state.height=t.current.offsetHeight)}),null!==this.state.refclassname.current&&(this.state.width<this.state.refclassname.current.offsetWidth&&(this.state.width=this.state.refclassname.current.offsetWidth),this.state.height<this.state.refclassname.current.offsetHeight&&(this.state.height=this.state.refclassname.current.offsetHeight)),null!==this.props.mountCallback?this.props.mountCallback(this.props.name,{width:this.state.width,height:this.state.height},this.getPointPosition):this.setState({})}),this.getPointPosition=(t=>{let e={x:0,y:0};return t.includes("top")?e.y=this.state.top:t.includes("bottom")?e.y=this.state.top+this.state.height:e.y=this.state.top+this.state.height/2,t.includes("left")?e.x=this.state.left:t.includes("right")?e.x=this.state.left+this.state.width:e.x=this.state.left+this.state.width/2,e}),this.getPointPositionForChildren=(t=>{let e={x:0,y:0};return t.includes("top")?e.y=0:t.includes("bottom")?e.y=this.state.height:e.y=this.state.height/2,t.includes("left")?e.x=0:t.includes("right")?e.x=this.state.width:e.x=this.state.width/2,e}),this.state={first_render:!0,top:0,left:0,width:null,height:null,rendered:!1,siblings:[],snapchildren:{},refchildren:[],refclassname:s.createRef()}}render(){if(this.state.first_render)return this.state.first_render=!1,console.log(this.props),s.createElement("div",{style:{position:"absolute",overflow:"hidden",top:this.state.top,left:this.state.left,height:this.state.height,width:this.state.width}},s.createElement("div",{className:this.props.className,ref:this.state.refclassname},s.Children.map(this.props.children,t=>t.props.is_snapbox?s.cloneElement(t,{mountCallback:this.childCallback}):s.cloneElement(t,{ref:t=>{this.state.refchildren.push(t)}}))));let t,e,i,o,h,l,n,a;if(t=!1,e={x:null,y:null},i={x:null,y:null},o={x:null,y:null},h={x:null,y:null},l=n=a=!1,this.props.processedsnaps.forEach(s=>{let r=s.locator(s.snappoint);s.localpoint.includes("top")?(a=!0,s.localpoint.includes("left")||(i.y=r.y),s.localpoint.includes("right")||(e.y=r.y)):s.localpoint.includes("bottom")&&(a=!0,s.localpoint.includes("left")||(h.y=r.y),s.localpoint.includes("right")||(o.y=r.y)),s.localpoint.includes("left")?(n=!0,s.localpoint.includes("top")||(o.x=r.x),s.localpoint.includes("bottom")||(e.x=r.x)):s.localpoint.includes("right")&&(n=!0,s.localpoint.includes("top")||(h.x=r.x),s.localpoint.includes("bottom")||(i.x=r.x)),"center"===s.localpoint&&(t=r,l=!0)}),e.y=i.y=Math.max(e.y,i.y),o.y=h.y=null===o.y?null===h.y?0:h.y:null===h.y?bottomrleft.y:Math.min(o.y,h.y),e.x=o.x=Math.max(e.x,o.x),i.x=h.x=null===i.x?null===h.x?0:h.x:null===h.x?i.x:Math.min(i.x,h.x),l){let s,l;s=a?Math.min(t.y-e.y,o.y-t.y):this.state.height/2,e.y=i.y=t.y-s,o.y=h.y=t.y+s,l=n?Math.min(t.x-e.x,i.x-t.x):this.state.width/2,e.x=o.x=t.x-l,i.x=h.x=t.x+l}let r=i.x-e.x;r<this.state.width&&(e.x=o.x=e.x-(this.state.width-r)/2,i.x=h.x=i.x+(this.state.width+r)/2);let p=o.y-e.y;return p<this.state.height&&(e.y=i.y=e.y-(this.state.height-p)/2,o.y=h.y=o.y-(this.state.height+p)/2),(l||n||a)&&(this.state.top=e.y,this.state.left=e.x,this.state.height=o.y-e.y,this.state.width=i.x-e.x),s.createElement("div",{style:{position:"absolute",overflow:"hidden",top:this.state.top,left:this.state.left,height:this.state.height,width:this.state.width}},s.createElement("div",{className:this.props.className,ref:this.state.refclassname},s.Children.map(this.props.children,t=>t.props.is_snapbox?s.cloneElement(t,{mountCallback:this.childCallback,processedsnaps:t.props.snaps.map(t=>"parent"===t.locator?{locator:this.getPointPositionForChildren,localpoint:t.localpoint,snappoint:t.snappoint}:{locator:this.state.snapchildren[t.locator],localpoint:t.localpoint,snappoint:t.snappoint})}):s.cloneElement(t,{ref:t=>{this.state.refchildren.push(t)}}))))}componentDidMount(){this.updateDimensions(),window.addEventListener("resize",this.updateDimensions)}componentWillUnmount(){window.removeEventListener("resize",this.updateDimensions)}}return i.defaultProps={snaps:[],processedsnaps:[],mountCallback:null,is_snapbox:!0},i.propTypes={name:e.string,snaps:e.arrayOf(e.shape({locator:e.string,localpoint:e.oneOf(["top","left","center","right","bottom","topleft","topright","bottomright","bottomleft"]),snappoint:e.oneOf(["top","left","center","right","bottom","topleft","topright","bottomright","bottomleft"])})),processedsnaps:e.arrayOf(e.shape({locator:e.func,localpoint:e.oneOf(["top","left","center","right","bottom","topleft","topright","bottomright","bottomleft"]),snappoint:e.oneOf(["top","left","center","right","bottom","topleft","topright","bottomright","bottomleft"])})),mountCallback:e.func,is_snapbox:e.bool},CSSModules(i,styles)});

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react"),require("react-jss"),require("prop-types"),require("classnames")):"function"==typeof define&&define.amd?define(["react","react-jss","prop-types","classnames"],e):t.snapbox=e(t.React,t.withStyles,t.PropTypes,t.classnames)}(this,function(t,e,s,i){"use strict";var o="default"in t?t.default:t,a="default"in e?e.default:e;s=s&&s.hasOwnProperty("default")?s.default:s,i=i&&i.hasOwnProperty("default")?i.default:i;class n extends t.Component{constructor(t){super(t),this.childCallback=((t,e,s)=>{this.state.snapchildren[t]=s,this.state.width<e.width&&(this.state.width=e.width),this.state.height<e.height&&(this.state.height=e.height)}),this.updateDimensions=(()=>{this.state.refchildren.forEach(t=>{this.state.width<t.current.offsetWidth&&(this.state.width=t.current.offsetWidth),this.state.height<t.current.offsetHeight&&(this.state.height=t.current.offsetHeight)}),null!==this.state.refclassname.current&&(this.state.width<this.state.refclassname.current.offsetWidth&&(this.state.width=this.state.refclassname.current.offsetWidth),this.state.height<this.state.refclassname.current.offsetHeight&&(this.state.height=this.state.refclassname.current.offsetHeight)),null!==this.props.mountCallback?this.props.mountCallback(this.props.name,{width:this.state.width,height:this.state.height},this.getPointPosition):this.setState({})}),this.getPointPosition=(t=>{let e={x:null,y:null};return t.includes("top")?e.y=this.state.top:t.includes("bottom")?e.y=this.state.top+this.state.height:e.y=this.state.top+this.state.height/2,t.includes("left")?e.x=this.state.left:t.includes("right")?e.x=this.state.left+this.state.width:e.x=this.state.left+this.state.width/2,e}),this.getPointPositionForChildren=(t=>{let e={x:0,y:0};return t.includes("top")?e.y=0:t.includes("bottom")?e.y=this.state.height:e.y=this.state.height/2,t.includes("left")?e.x=0:t.includes("right")?e.x=this.state.width:e.x=this.state.width/2,e}),this.state={first_render:!0,top:0,left:0,width:null,height:null,rendered:!1,siblings:[],snapchildren:{},refchildren:[],refclassname:o.createRef()}}render(){if(this.state.first_render)return console.log(this.props.name+" did first render"),this.state.first_render=!1,o.createElement("div",{className:this.props.classes.snapbox,style:{top:this.state.top,left:this.state.left,height:this.state.height,width:this.state.width}},o.createElement("div",{className:this.props.className,ref:this.state.refclassname},o.Children.map(this.props.children,t=>t.props.is_snapbox?o.cloneElement(t,{mountCallback:this.childCallback}):o.cloneElement(t,{ref:t=>{this.state.refchildren.push(t)}}))));let t,e,s,i,a,n,h,l;if(console.log(this.props.name+" did render"),t=!1,e={x:0,y:0,xset:!1,yset:!1},s={x:0,y:0,xset:!1,yset:!1},i={x:0,y:0,xset:!1,yset:!1},a={x:0,y:0,xset:!1,yset:!1},n=h=l=!1,this.props.processedsnaps.forEach(o=>{let r=o.locator(o.snappoint);console.log(this.props.name+" snapped "+o.localpoint+" to "+o.snappoint),o.localpoint.includes("top")?(l=!0,o.localpoint.includes("left")||(s.y=r.y,s.yset=!0),o.localpoint.includes("right")||(e.y=r.y,e.yset=!0)):o.localpoint.includes("bottom")&&(l=!0,o.localpoint.includes("left")||(a.y=r.y,a.yset=!0),o.localpoint.includes("right")||(i.y=r.y,i.yset=!0)),o.localpoint.includes("left")?(h=!0,o.localpoint.includes("top")||(i.x=r.x,i.xset=!0),o.localpoint.includes("bottom")||(e.x=r.x,e.xset=!0)):o.localpoint.includes("right")&&(h=!0,o.localpoint.includes("top")||(a.x=r.x,a.xset=!0),o.localpoint.includes("bottom")||(s.x=r.x,s.xset=!0)),"center"===o.localpoint&&(t=r,n=!0)}),e.y=s.y=Math.max(e.y,s.y),i.y=a.y=i.yset?a.yset?Math.min(i.y,a.y):i.y:a.yset?a.y:0,e.x=i.x=Math.max(e.x,i.x),s.x=a.x=s.xset?a.xset?Math.min(s.x,a.x):s.x:a.xset?a.x:0,n){let o,n;o=l?Math.min(t.y-e.y,i.y-t.y):this.state.height/2,e.y=s.y=t.y-o,i.y=a.y=t.y+o,n=h?Math.min(t.x-e.x,s.x-t.x):this.state.width/2,e.x=i.x=t.x-n,s.x=a.x=t.x+n}let r=s.x-e.x;r<this.state.width&&(e.x=i.x=e.x-(this.state.width-r)/2,s.x=a.x=s.x+(this.state.width+r)/2);let p=i.y-e.y;return p<this.state.height&&(e.y=s.y=e.y-(this.state.height-p)/2,i.y=a.y=i.y-(this.state.height+p)/2),(n||h||l)&&(this.state.top=e.y,this.state.left=e.x,this.state.height=i.y-e.y,this.state.width=s.x-e.x),o.createElement("div",{className:this.props.classes.snapbox,style:{top:this.state.top,left:this.state.left,height:this.state.height,width:this.state.width}},o.createElement("div",{className:this.props.className,ref:this.state.refclassname},o.Children.map(this.props.children,t=>t.props.is_snapbox?o.cloneElement(t,{mountCallback:this.childCallback,processedsnaps:t.props.snaps.map(t=>"parent"===t.locator?{locator:this.getPointPositionForChildren,localpoint:t.localpoint,snappoint:t.snappoint}:{locator:this.state.snapchildren[t.locator],localpoint:t.localpoint,snappoint:t.snappoint})}):o.cloneElement(t,{ref:t=>{this.state.refchildren.push(t)}}))))}componentDidMount(){console.log(this.props.name+" did mount"),this.updateDimensions(),window.addEventListener("resize",this.updateDimensions)}componentWillUnmount(){window.removeEventListener("resize",this.updateDimensions)}}return n.defaultProps={snaps:[],processedsnaps:[],mountCallback:null,is_snapbox:!0},n.propTypes={name:s.string,snaps:s.arrayOf(s.shape({locator:s.string,localpoint:s.oneOf(["top","left","center","right","bottom","topleft","topright","bottomright","bottomleft"]),snappoint:s.oneOf(["top","left","center","right","bottom","topleft","topright","bottomright","bottomleft"])})),processedsnaps:s.arrayOf(s.shape({locator:s.func,localpoint:s.oneOf(["top","left","center","right","bottom","topleft","topright","bottomright","bottomleft"]),snappoint:s.oneOf(["top","left","center","right","bottom","topleft","topright","bottomright","bottomleft"])})),mountCallback:s.func,is_snapbox:s.bool},a(t=>({snapbox:{position:"absolute",overflow:"hidden"}}))(n)});
